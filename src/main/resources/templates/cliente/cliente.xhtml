
<html xmlns:th="www.thymeleaf.org"
	th:replace="~{padrao/template :: layout (~{:: main},~{::head})}">
<head>
<link th:href="@{/css/cliente/cliente.css}" rel="stylesheet">
<script th:src="@{/js/cliente/clientes.js}" defer></script>

</head>
<body>
	<main class=" vh-100">
		<div th:switch="${feedback.status}">
			<div th:case="'FALHA'"
				class="alert alert-dismissible alert-danger fade show" role="alert"
				id="cnt_msg">
				<p th:text="${feedback.mensagem}"></p>

			</div>
			<div th:case="'SUCESSO'"
				class="alert alert-dismissible alert-success fade show" role="alert"
				id="cnt_msg">
				<p th:text="${feedback.mensagem}"></p>
				<!-- 				<button type="button" class="btn-close" data-bs-dismiss="alert" -->
				<!-- 					aria-label="Close"></button> -->
			</div>
			<div th:case="'INFO'"
				class="alert alert-dismissible fade show text-bg-light" role="alert"
				id="cnt_msg">
				<p th:text="${feedback.mensagem}"></p>
				<!-- 				<button type="button" class="btn-close" data-bs-dismiss="alert" -->
				<!-- 					aria-label="Close"></button> -->
			</div>
		</div>

		<div class="container-fluid ">
			<h2>Clientes</h2>
			<hr>
			<div class="shadow p-2">
				<form class="row" th:object="${pesquisa}"
					th:action="@{/sigec/clientes/pesquisa}" method="POST">
					<div class="col">
						<label class="form-label">Nome: </label> <input
							class="form-control" type="text" th:field=*{pesquisaNome} />
					</div>
					<div class="col">
						<label class="form-label">CPF:</label><input class="form-control"
							th:oninput="mascara(this)" type="text" th:field=*{pesquisaCpf} />
					</div>
					<div class="col">
						<label class="form-label">Clientes por tela:</label><select
							class="form-select"
							th:classappend="${#fields.hasErrors('paginas')}?'border border-danger':'nda'"
							id="paginas" th:field="*{paginas}">
							<option value=5>5</option>
							<option value=10>10</option>
							<option value=20>20</option>
						</select>
					</div>
					<div class="d-flex">
						<input class="btn btn-primary mt-4" type="submit"
							value="Pesquisar">
						<div>
							<a class="btn btn-success mx-5 mt-4"
								th:href="@{/sigec/cliente/adicionar}">Cadastrar</a>
						</div>
					</div>
				</form>
			</div>
		</div>


		<div id="accordion" class="container-fluid p-2"
			th:if="${lista_clientes.size() > 0}">
			<table class="table table-light table-striped rouded-top shadow ">
				<thead>
					<tr>
						<!-- 						<th>Id</th> -->
						<th class="table-light">Nome</th>
						<th class="table-light">Telefone</th>
						<th class="table-light">CPF</th>
						<th class="table-light">RG</th>

						<th class="table-light">Ações</th>

					</tr>
				</thead>
				<tbody>
					<tr th:each="cliente, iStat : ${lista_clientes}"
						th:style="${iStat.odd}? 'font-weight:bold;'">
						<!-- 						<td th:text="${cliente.id}">id</td> -->

						<td th:text="${cliente.nome}">nome</td>
						<td><span class="m-2"
							th:each="telefone, iStat : ${cliente.telefones}"
							th:text="${telefone.numero}"></span></td>
						<td th:text="${cliente.cpf}">cpf</td>
						<td th:text="${cliente.rg}">rg</td>

						<td>
							<div>
								<a class="btn btn-primary" data-bs-custom-tooltip="tooltip"
									title="Editar" data-bs-custom-class="custom-tooltip"
									th:href="@{/sigec/cliente/editar(id =${cliente.id})}"> <span><img
										th:src="@{/img/pencil-square.svg}" alt="docs" width="16"
										height="16"></span></a> <a class="btn btn-warning"
									data-bs-tooltip="tooltip" title="Documentos"
									th:href="@{/sigec/cliente/docs(id =${cliente.id})}"> <img
									th:src="@{/img/file-text.svg}" alt="docs" width="16"
									height="16"></a>
								<button id="showModalProc" class="btn btn-info"
									data-bs-toggle="modal" data-bs-target="#modalProc"
									data-bs-tooltip="tooltip" title="Procuração"
									th:href="@{/sigec/cliente/proc(id =${cliente.id})}">
									<img th:src="@{/img/file-text.svg}" alt="docs" width="16"
										height="16">
								</button>
								<div class="modal fade" id="modalProc" tabindex="-1"
									aria-labelledby="exampleModalLabel" aria-hidden="true">
									<div class="modal-dialog">
										<div class="modal-content">
											<div class="modal-header">
												<h1 class="modal-title fs-5" id="exampleModalLabel">Procuração</h1>
												<button type="button" class="btn-close"
													data-bs-dismiss="modal" aria-label="Close"></button>
											</div>
											<div class="modal-body">
												<form th:action="@{/sigec/cliente/proc}">
													<input type="text" class="form-control" th:name="id"
														th:value=${cliente.id} hidden><input type="text"
														class="form-control mt-1 mb-1" th:name="tipo"
														placeholder="Tipo de ação..."><input type="submit"
														class="btn btn-success w-100 mt-2 text-light"
														value="Gerar">
												</form>
											</div>
											<div class="modal-footer">
												<button type="button" class="btn btn-secondary"
													data-bs-dismiss="modal">Fechar</button>

											</div>
										</div>
									</div>
								</div>


								<a class="btn btn-secondary" data-bs-tooltip="tooltip"
									title="Declaração Hiposuficiência"
									th:href="@{/sigec/cliente/hipo(id =${cliente.id})}"> <img
									th:src="@{/img/file-text.svg}" alt="docs" width="16"
									height="16"></a> <a class="btn"
									style="background-color: #229678" data-bs-tooltip="tooltip"
									title="Pagamentos"
									th:href="@{/sigec/cliente/pagamentos(id =${cliente.id})}">
									<img th:src="@{/img/cash-coin.svg}" alt="docs" width="16"
									height="16">
								</a> <a class="btn btn-danger" data-bs-tooltip="tooltip"
									title="Deletar"
									th:href="@{/sigec/cliente/delete(id =${cliente.id})}"> <img
									th:src="@{/img/trash.svg}" alt="docs" width="16" height="16"></a>

							</div>
						</td>
					</tr>
				</tbody>
				
			</table>

			<div class="d-flex justify-content-center" th:if="${totalPages > 1}">

				<a class="me-3" th:classappend="${currentPage==1}?invisible:visible"
					th:style="${currentPage==1}?disabled:enabled"
					th:href="@{/sigec/clientes(page=${currentPage-1},size=${pesquisa.paginas})}">
					<img th:src="@{/img/arrow-left-square.svg}" alt="docs" width="32"
					height="32">
				</a>


				<p class="page_counter"
					th:text="${#strings.concat(texto_pagina, currentPage)}">page</p>


				<a class="ms-3"
					th:classappend="${currentPage==totalPages}?invisible:visible"
					th:style="${currentPage==totalPages}?disabled:enabled"
					th:href="@{/sigec/clientes(page=${currentPage+1},size=${pesquisa.paginas})}">
					<img th:src="@{/img/arrow-right-square.svg}" alt="docs" width="32"
					height="32">
				</a>
			</div>

		</div>

		<div class="tabela d-flex align-items-center justify-content-center" th:else="${lista_clientes.size() > 0}">
			<h2 th:text="${mensagem_tabela}">Sem retorno para sua pesquisa!</h2>
		</div>
	</main>


</body>
</html>